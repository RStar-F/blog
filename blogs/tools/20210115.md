---
title: js常用工具方法
date: 2021-01-15
tags:
 - js封装
categories: 
 - 工具
---
### H5复制内容到剪切板

方法一

```javascript
export function copyContent1(content = '') {
  try {
    ;
    const oInput = document.createElement("input");
    document.body.appendChild(oInput);
    oInput.value = content;
    oInput.setAttribute('readOnly', 'readOnly')
    oInput.select();
    document.execCommand("Copy");
    document.body.removeChild(oInput);
    console.log('copyContent suc', content)
  } catch (e) {
    console.log('copyContent err', content)
  }
}
```

方法二

```javascript
export function copyContent (content) {
  var copyDom = document.createElement('div')
  copyDom.innerText = content
  copyDom.style.position = 'absolute'
  copyDom.style.top = '0px'
  copyDom.style.right = '-9999px'
  document.body.appendChild(copyDom)
  // 创建选中范围
  var range = document.createRange()
  range.selectNode(copyDom)
  // 移除剪切板中内容
  window.getSelection().removeAllRanges()
  // 添加新的内容到剪切板
  window.getSelection().addRange(range)
  // 复制
  var successful = document.execCommand('copy')
  copyDom.parentNode.removeChild(copyDom)
  try {
    var msg = successful ? "successful" : "failed"
    console.log('Copy command was : ' + msg)
  } catch (err) {
    console.log('Oops , unable to copy!')
  }
}
```
### 解析URL参数

```javascript
const getParameters = URL => JSON.parse(`{"${decodeURI(URL.split("?")[1]).replace(/"/g, '\\"').replace(/&/g, '","').replace(/=/g, '":"')}"}`
  )
```

### 节流、防抖

```javascript
// fn 需要防抖的函数，delay 为定时器时间
function debounce(fn,delay){
    let timer =  null  // 用于保存定时器
    return function () { 
        // 如果timer存在 就清除定时器，重新计时
        if(timer){
            clearTimeout(timeout);
        }
        //设置定时器，规定时间后执行真实要执行的函数
        timeout = setTimeout(() => {
            fn.apply(this);
        }, delay);
    }
}

// 节流
function throttle(fn) {
  let timer = null; // 首先设定一个变量，没有执行定时器时,默认为 null
  return function () {
    if (timer) return; // 当定时器没有执行的时候timer永远是false,后面无需执行
    timer = setTimeout(() => {
      fn.apply(this, arguments);
        // 最后在setTimeout执行完毕后再把标记设置为true(关键)
        // 表示可以执行下一次循环了。
      timer = null;
    }, 1000);
  };
}
```

### 深度克隆
```javascript
function cloneDeep(data) {
  const t = typeOf(data);
  let o;

  if (t === 'array') {
    o = [];
  } else if (t === 'object') {
    o = {};
  } else {
    return data;
  }

  if (t === 'array') {
    for (let i = 0; i < data.length; i += 1) {
      o.push(cloneDeep(data[i]));
    }
  } else if (t === 'object') {
    for (const i in data) {
      o[i] = cloneDeep(data[i]);
    }
  }
  return o;
}
```
