---
title: js常用工具方法
date: 2021-01-15
tags:
 - js封装
categories: 
 - 工具
---
### H5复制内容到剪切板

```javascript
export const copyText = (function () {
  if (navigator.clipboard) {
    return (text) => {
      navigator.clipboard.writeText(text);
    };
  } else {
    return (text) => {
      const input = document.createElement('input');
      input. setAttribute('value', text);
      document. body.appendChild(input);
      input.select();
      document.execCommand( ' copy');
      document.body. removeChild(input);
    }
  }
})()

```
### 解析URL参数

```javascript
// 方法一 此方法如果url没有问号会报错
const getParameters = URL => JSON.parse(`{"${decodeURI(URL.split("?")[1]).replace(/"/g, '\\"').replace(/&/g, '","').replace(/=/g, '":"')}"}`
  )

// 方法二
/**
 * 获取URL的参数
 * @param {*} URL
 * @returns Object
 */
export function getParams (url) {
  const result = {}
  if (!url) return result
  const queryStr = url.split('?')[1]
  if (!queryStr) return result
  const queryArr = queryStr.split('&')
  queryArr.forEach(query => {
    const [name, value] = query.split('=')
    result[name] = value
  })
  return result
}
```

### 节流、防抖

```javascript
// fn 需要防抖的函数，delay 为定时器时间
function debounce(fn,delay){
    let timer =  null  // 用于保存定时器
    return function () { 
        // 如果timer存在 就清除定时器，重新计时
        if(timer){
            clearTimeout(timeout);
        }
        //设置定时器，规定时间后执行真实要执行的函数
        timeout = setTimeout(() => {
            fn.apply(this);
        }, delay);
    }
}

// 节流
function throttle(fn) {
  let timer = null; // 首先设定一个变量，没有执行定时器时,默认为 null
  return function () {
    if (timer) return; // 当定时器没有执行的时候timer永远是false,后面无需执行
    timer = setTimeout(() => {
      fn.apply(this, arguments);
        // 最后在setTimeout执行完毕后再把标记设置为true(关键)
        // 表示可以执行下一次循环了。
      timer = null;
    }, 1000);
  };
}
```

### 深度克隆
```javascript
function cloneDeep(data) {
  const t = typeOf(data);
  let o;

  if (t === 'array') {
    o = [];
  } else if (t === 'object') {
    o = {};
  } else {
    return data;
  }

  if (t === 'array') {
    for (let i = 0; i < data.length; i += 1) {
      o.push(cloneDeep(data[i]));
    }
  } else if (t === 'object') {
    for (const i in data) {
      o[i] = cloneDeep(data[i]);
    }
  }
  return o;
}
```
